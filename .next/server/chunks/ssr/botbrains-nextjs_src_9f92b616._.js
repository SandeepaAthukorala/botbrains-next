module.exports=[88025,a=>{"use strict";var b=a.i(76983);a.i(958);var c=a.i(55475);let d="workspaces";async function e(a,f,g="ðŸ’¼",h="#6366f1",i=""){let j=new Date().toISOString(),k=`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,l={id:k,profileId:a,name:f,icon:g,color:h,description:i,settings:{autoBackup:!0,backupFrequency:"daily",viewPreferences:{defaultView:"card",sortBy:"updated"}},isDefault:!1,created_at:j,updated_at:j};return await (0,c.setDoc)((0,c.doc)(b.db,d,k),l),l}async function f(a){let e=(0,c.doc)(b.db,d,a),f=await (0,c.getDoc)(e);if(f.exists())return f.data()}async function g(a){let e=(0,c.query)((0,c.collection)(b.db,d),(0,c.where)("profileId","==",a));return(await (0,c.getDocs)(e)).docs.map(a=>a.data())}async function h(a){let e=(0,c.query)((0,c.collection)(b.db,d),(0,c.where)("profileId","==",a),(0,c.where)("isDefault","==",!0)),f=await (0,c.getDocs)(e);if(!f.empty)return f.docs[0].data()}async function i(a,e){let f=(0,c.doc)(b.db,d,a);await (0,c.updateDoc)(f,{...e,updated_at:new Date().toISOString()})}async function j(a,b){let c=await f(a);if(!c)throw Error("Workspace not found");await i(a,{settings:{...c.settings,...b}})}async function k(a){let e=await f(a);if(!e)throw Error("Workspace not found");let h=(0,c.writeBatch)(b.db);(await g(e.profileId)).forEach(a=>{let e=(0,c.doc)(b.db,d,a.id);h.update(e,{isDefault:!1})});let i=(0,c.doc)(b.db,d,a);h.update(i,{isDefault:!0}),await h.commit()}async function l(a){let e=(0,c.query)((0,c.collection)(b.db,"prompts"),(0,c.where)("workspaceId","==",a));(await (0,c.getDocs)(e)).forEach(a=>(0,c.deleteDoc)(a.ref));let f=(0,c.query)((0,c.collection)(b.db,"categories"),(0,c.where)("workspaceId","==",a));(await (0,c.getDocs)(f)).forEach(a=>(0,c.deleteDoc)(a.ref));let g=(0,c.query)((0,c.collection)(b.db,"keywords"),(0,c.where)("workspaceId","==",a));(await (0,c.getDocs)(g)).forEach(a=>(0,c.deleteDoc)(a.ref)),await (0,c.deleteDoc)((0,c.doc)(b.db,d,a))}async function m(a){let e=(0,c.doc)(b.db,d,a);await (0,c.updateDoc)(e,{lastBackupAt:new Date().toISOString()})}a.s(["createWorkspace",()=>e,"deleteWorkspace",()=>l,"getDefaultWorkspace",()=>h,"getWorkspace",()=>f,"getWorkspacesByProfile",()=>g,"setDefaultWorkspace",()=>k,"updateLastBackup",()=>m,"updateWorkspace",()=>i,"updateWorkspaceSettings",()=>j])},34666,a=>{"use strict";var b=a.i(75345),c=a.i(76983);a.i(958);var d=a.i(55475);let e="profiles";async function f(a,b,f,g){let h=new Date().toISOString(),i=`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,j={id:i,googleId:a,email:b,name:f,avatar:g,preferences:{theme:"dark",language:"en",animations:!0},created_at:h,updated_at:h};return await (0,d.setDoc)((0,d.doc)(c.db,e,i),j),j}async function g(a){let b=(0,d.doc)(c.db,e,a),f=await (0,d.getDoc)(b);if(f.exists())return f.data()}async function h(a){let b=(0,d.query)((0,d.collection)(c.db,e),(0,d.where)("googleId","==",a)),f=await (0,d.getDocs)(b);if(!f.empty)return f.docs[0].data()}async function i(){return(await (0,d.getDocs)((0,d.collection)(c.db,e))).docs.map(a=>a.data())}async function j(a,b){let f=(0,d.doc)(c.db,e,a);await (0,d.updateDoc)(f,{...b,updated_at:new Date().toISOString()})}async function k(a){let b=(0,d.writeBatch)(c.db),f=(0,d.query)((0,d.collection)(c.db,"workspaces"),(0,d.where)("profileId","==",a)),g=await (0,d.getDocs)(f),h=g.docs.map(a=>a.id);for(let a of(g.docs.forEach(a=>{b.delete(a.ref)}),h)){let b=(0,d.query)((0,d.collection)(c.db,"prompts"),(0,d.where)("workspaceId","==",a));(await (0,d.getDocs)(b)).forEach(a=>(0,d.deleteDoc)(a.ref));let e=(0,d.query)((0,d.collection)(c.db,"categories"),(0,d.where)("workspaceId","==",a));(await (0,d.getDocs)(e)).forEach(a=>(0,d.deleteDoc)(a.ref));let f=(0,d.query)((0,d.collection)(c.db,"keywords"),(0,d.where)("workspaceId","==",a));(await (0,d.getDocs)(f)).forEach(a=>(0,d.deleteDoc)(a.ref))}await b.commit(),await (0,d.deleteDoc)((0,d.doc)(c.db,e,a))}async function l(a,b){let c=await g(a);if(!c)throw Error("Profile not found");await j(a,{preferences:{...c.preferences,...b}})}let m=(0,b.create)((a,b)=>({currentProfile:null,profiles:[],isAuthenticated:!1,isLoading:!1,loadProfiles:async()=>{a({isLoading:!0});try{let b=await i();a({profiles:b,isLoading:!1})}catch(b){console.error("Failed to load profiles:",b),a({isLoading:!1})}},setCurrentProfile:b=>{a({currentProfile:b,isAuthenticated:null!==b})},switchProfile:async a=>{try{let c=await g(a);if(c)b().setCurrentProfile(c);else throw Error("Profile not found")}catch(a){throw console.error("Failed to switch profile:",a),a}},createNewProfile:async(b,c,d,e)=>{try{let g=await f(b,c,d,e);return a(a=>({profiles:[...a.profiles,g]})),g}catch(a){throw console.error("Failed to create profile:",a),a}},updateCurrentProfile:async c=>{let{currentProfile:d}=b();if(!d)throw Error("No profile is currently active");try{await j(d.id,c);let b=await g(d.id);b&&a(a=>({currentProfile:b,profiles:a.profiles.map(a=>a.id===d.id?b:a)}))}catch(a){throw console.error("Failed to update profile:",a),a}},updatePreferences:async c=>{let{currentProfile:d}=b();if(!d)throw Error("No profile is currently active");try{await l(d.id,c);let b=await g(d.id);b&&a(a=>({currentProfile:b,profiles:a.profiles.map(a=>a.id===d.id?b:a)}))}catch(a){throw console.error("Failed to update preferences:",a),a}},deleteCurrentProfile:async()=>{let{currentProfile:c}=b();if(!c)throw Error("No profile is currently active");try{await k(c.id),a(a=>({currentProfile:null,isAuthenticated:!1,profiles:a.profiles.filter(a=>a.id!==c.id)}))}catch(a){throw console.error("Failed to delete profile:",a),a}},logout:()=>{a({currentProfile:null,isAuthenticated:!1})},getOrCreateProfile:async(c,d,e,f)=>{try{let g=await h(c);if(g){let b=await i();a({profiles:b})}else g=await b().createNewProfile(c,d,e,f);return g}catch(a){throw console.error("Failed to get or create profile:",a),a}}}));a.s(["useProfileStore",0,m],34666)},36991,a=>{"use strict";var b=a.i(75345),c=a.i(88025);let d=(0,b.create)((a,b)=>({currentWorkspace:null,workspaces:[],isLoading:!1,loadWorkspaces:async b=>{a({isLoading:!0});try{let d=await (0,c.getWorkspacesByProfile)(b);a({workspaces:d,isLoading:!1})}catch(b){console.error("Failed to load workspaces:",b),a({isLoading:!1})}},setCurrentWorkspace:b=>{a({currentWorkspace:b})},switchWorkspace:async a=>{try{let d=await (0,c.getWorkspace)(a);if(d)b().setCurrentWorkspace(d);else throw Error("Workspace not found")}catch(a){throw console.error("Failed to switch workspace:",a),a}},createNewWorkspace:async(b,d,e,f,g)=>{try{let h=await (0,c.createWorkspace)(b,d,e,f,g);return a(a=>({workspaces:[...a.workspaces,h]})),h}catch(a){throw console.error("Failed to create workspace:",a),a}},updateCurrentWorkspace:async d=>{let{currentWorkspace:e}=b();if(!e)throw Error("No workspace is currently active");try{await (0,c.updateWorkspace)(e.id,d);let b=await (0,c.getWorkspace)(e.id);b&&a(a=>({currentWorkspace:b,workspaces:a.workspaces.map(a=>a.id===e.id?b:a)}))}catch(a){throw console.error("Failed to update workspace:",a),a}},updateSettings:async d=>{let{currentWorkspace:e}=b();if(!e)throw Error("No workspace is currently active");try{await (0,c.updateWorkspaceSettings)(e.id,d);let b=await (0,c.getWorkspace)(e.id);b&&a(a=>({currentWorkspace:b,workspaces:a.workspaces.map(a=>a.id===e.id?b:a)}))}catch(a){throw console.error("Failed to update settings:",a),a}},setAsDefault:async d=>{try{await (0,c.setDefaultWorkspace)(d);let e=await (0,c.getWorkspace)(d),{currentWorkspace:f}=b();e&&a(a=>({workspaces:a.workspaces.map(a=>({...a,isDefault:a.id===d})),currentWorkspace:f?.id===d?e:f}))}catch(a){throw console.error("Failed to set default workspace:",a),a}},deleteWorkspaceById:async d=>{try{await (0,c.deleteWorkspace)(d);let{currentWorkspace:e}=b();a(a=>({workspaces:a.workspaces.filter(a=>a.id!==d),currentWorkspace:e?.id===d?null:e}))}catch(a){throw console.error("Failed to delete workspace:",a),a}},loadDefaultWorkspace:async b=>{console.log("ðŸ¢ loadDefaultWorkspace called for profile:",b),a({isLoading:!0});try{let d=await (0,c.getDefaultWorkspace)(b);if(d)console.log("âœ… Found existing default workspace:",d.id,d.name),a({currentWorkspace:d,isLoading:!1});else{console.log("âš ï¸  No default workspace found - creating new one");let d=await (0,c.createWorkspace)(b,"My Workspace","ðŸ’¼","#6366f1");console.log("ðŸ’¾ Created new workspace:",d.id),await (0,c.setDefaultWorkspace)(d.id),console.log("âœ… Set new workspace as default");let e=await (0,c.getWorkspace)(d.id);a({currentWorkspace:e||d,workspaces:[e||d],isLoading:!1}),console.log("âœ… Default workspace loaded:",e?.id)}}catch(b){console.error("âŒ Failed to load default workspace:",b),a({isLoading:!1})}},markBackupComplete:async d=>{try{await (0,c.updateLastBackup)(d);let e=await (0,c.getWorkspace)(d),{currentWorkspace:f}=b();e&&a(a=>({workspaces:a.workspaces.map(a=>a.id===d?e:a),currentWorkspace:f?.id===d?e:f}))}catch(a){throw console.error("Failed to mark backup complete:",a),a}}}));a.s(["useWorkspaceStore",0,d])},99449,a=>{"use strict";var b=a.i(76983);a.i(93396);var c=a.i(79431);let d=["https://www.googleapis.com/auth/userinfo.profile","https://www.googleapis.com/auth/userinfo.email","https://www.googleapis.com/auth/drive.file"],e=new class{async init(){return Promise.resolve()}async signIn(){try{let a=new c.GoogleAuthProvider;d.forEach(b=>a.addScope(b));let e=await (0,c.signInWithPopup)(b.auth,a),f=e.user,g=c.GoogleAuthProvider.credentialFromResult(e),h=g?.accessToken;return h&&this.storeToken(h),{id:f.uid,email:f.email,name:f.displayName,picture:f.photoURL,accessToken:h}}catch(a){throw console.error("âŒ Firebase Sign-in Error:",a),{type:"tokenFailed",idpId:"google",error:a.message||"server_error"}}}async signOut(){try{await (0,c.signOut)(b.auth),localStorage.removeItem("google_access_token"),localStorage.removeItem("google_token_expiry")}catch(a){console.error("Error signing out:",a)}}storeToken(a){let b=new Date().getTime()+36e5;localStorage.setItem("google_access_token",a),localStorage.setItem("google_token_expiry",b.toString())}getAccessToken(){let a=localStorage.getItem("google_access_token"),b=localStorage.getItem("google_token_expiry");return!a||!b||new Date().getTime()>parseInt(b)?null:a}waitForAuth(){return new Promise(a=>{let c=b.auth.onAuthStateChanged(b=>{c(),a(b)})})}async isAuthenticated(){return!!await this.waitForAuth()}async getCurrentUser(){let a=await this.waitForAuth();return a?{id:a.uid,email:a.email,name:a.displayName,picture:a.photoURL}:null}};a.s(["googleAuth",0,e])}];

//# sourceMappingURL=botbrains-nextjs_src_9f92b616._.js.map